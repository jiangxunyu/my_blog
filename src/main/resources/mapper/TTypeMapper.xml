<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jxy.my_blog.mapper.TTypeMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.jxy.my_blog.entity.TType">
        <id column="id" property="id" />
        <result column="name" property="name" />
        <collection property="blogs" javaType="com.jxy.my_blog.entity.TBlog">
            <id column="blog_id" property="id" />
            <result column="title" property="title" />
            <result column="content" property="content" />
            <result column="first_picture" property="firstPicture" />
            <result column="flag" property="flag" />
            <result column="views" property="views" />
            <result column="appreciation" property="appreciation" />
            <result column="share_statement" property="shareStatement" />
            <result column="commentabled" property="commentabled" />
            <result column="published" property="published" />
            <result column="recommend" property="recommend" />
            <result column="create_time" property="createTime" />
            <result column="update_time" property="updateTime" />
            <result column="tagIds" property="tagIds" />
            <result column="description" property="description" />
        </collection>
    </resultMap>

    <sql id="blog_columns">
        t2.id blog_id,
        t2.title,
        t2.content,
        t2.first_picture,
        t2.flag,
        t2.views,
        t2.appreciation,
        t2.share_statement,
        t2.commentabled,
        t2.published,
        t2.recommend,
        t2.create_time,
        t2.update_time,
        t2.tagIds,
        t2.description,
        t2.user_id,
        t2.type_id
    </sql>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        t1.id, t1.name
    </sql>

    <select id="listType" resultMap="BaseResultMap">
        select <include refid="Base_Column_List"/>,<include refid="blog_columns"/>
        from t_type t1
        left join t_blog t2 on t1.id = t2.type_id
    </select>

    <select id="listAllType" resultMap="BaseResultMap">
        select <include refid="Base_Column_List"/>,<include refid="blog_columns"/>
        from t_type t1
        left join t_blog t2 on t1.id = t2.type_id
    </select>

    <select id="getTypeById" resultMap="BaseResultMap">
        select <include refid="Base_Column_List"/>,<include refid="blog_columns"/>
        from t_type t1
        left join t_blog t2 on t1.id = t2.type_id
        where t1.id = #{id}
    </select>

    <select id="getTypeByName" resultMap="BaseResultMap">
        select <include refid="Base_Column_List"/>,<include refid="blog_columns"/>
        from t_type t1
        left join t_blog t2 on t1.id = t2.type_id
        where t1.name = #{name} limit 1
    </select>

    <select id="getTypes" resultType="com.jxy.my_blog.entity.TType">
        select <include refid="Base_Column_List"/>
        from t_type t1
    </select>

</mapper>
